<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Advanced Weather App</title>
  <style>
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background: linear-gradient(to bottom, #68aee3, #1d4ed8);
      color: #fff;
      overflow-x: hidden;
      transition: background 0.3s, color 0.3s;
    }
    .light-mode {
      background: linear-gradient(to bottom, #dbeeff, #91c6ff);
      color: #222;
    }
    .container {
      max-width: 500px;
      margin: 60px auto;
      padding: 25px;
      background-color: rgba(0, 0, 0, 0.3);
      backdrop-filter: blur(10px);
      border-radius: 15px;
      text-align: center;
    }
    .light-mode .container {
      background-color: rgba(255, 255, 255, 0.6);
    }
    input, select {
      width: 100%;
      padding: 10px;
      margin: 10px 0;
      border-radius: 8px;
      border: none;
      font-size: 16px;
    }
    button {
      padding: 10px 15px;
      margin: 5px;
      border: none;
      border-radius: 8px;
      background-color: #004aad;
      color: white;
      cursor: pointer;
      font-weight: bold;
    }
    .toggle-btn {
      float: right;
      margin-top: -40px;
    }
    .weather, .forecast {
      margin-top: 20px;
    }
    .forecast-day {
      display: inline-block;
      width: 100px;
      margin: 10px;
    }
    .forecast-day img {
      width: 50px;
    }
    .error {
      color: #ffdddd;
      margin-top: 10px;
    }
    footer {
      text-align: center;
      margin-top: 40px;
      font-size: 14px;
      color: rgba(255, 255, 255, 0.7);
    }
    .light-mode footer {
      color: rgba(0, 0, 0, 0.6);
    }

    /* Dynamic Weather Backgrounds */
    .weather-bg {
      position: fixed;
      top: 0; left: 0;
      width: 100vw;
      height: 100vh;
      z-index: -1;
      pointer-events: none;
      overflow: hidden;
    }

    /* Sun */
    .sun-rays {
      position: absolute;
      top: -100px;
      left: 50%;
      transform: translateX(-50%);
      width: 300px;
      height: 300px;
      background: radial-gradient(circle, rgba(255,255,0,0.3) 0%, transparent 80%);
      border-radius: 50%;
      animation: pulse 5s ease-in-out infinite;
    }

    @keyframes pulse {
      0%, 100% {
        transform: translateX(-50%) scale(1);
        opacity: 0.4;
      }
      50% {
        transform: translateX(-50%) scale(1.2);
        opacity: 0.8;
      }
    }

    /* Clouds */
    .cloud {
      position: absolute;
      background: rgba(255, 255, 255, 0.8);
      border-radius: 50%;
      animation: cloudMove 60s linear infinite;
    }

    .cloud1 { top: 80px; left: -200px; width: 180px; height: 70px; }
    .cloud2 { top: 150px; left: -300px; width: 250px; height: 100px; animation-delay: 15s; }
    .cloud3 { top: 230px; left: -150px; width: 140px; height: 60px; animation-delay: 30s; }

    @keyframes cloudMove {
      0% { transform: translateX(0); }
      100% { transform: translateX(130vw); }
    }

    /* Rain */
    .rain {
      width: 2px;
      height: 20px;
      background: rgba(255,255,255,0.5);
      position: absolute;
      animation: rainFall 1s linear infinite;
    }

    @keyframes rainFall {
      0% { top: -20px; }
      100% { top: 100vh; }
    }

    /* Snow */
    .snowflake {
      position: absolute;
      color: white;
      font-size: 1.2em;
      animation: snowFall 10s linear infinite;
    }

    @keyframes snowFall {
      0% { transform: translateY(0); }
      100% { transform: translateY(100vh); }
    }

    /* Fog */
    .fog {
      position: absolute;
      top: 0; left: 0;
      width: 100%;
      height: 100%;
      background: rgba(200, 200, 200, 0.2);
      backdrop-filter: blur(3px);
    }

    /* Lightning */
    .lightning {
      position: absolute;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      background: white;
      opacity: 0;
      animation: lightningFlash 5s infinite;
    }

    @keyframes lightningFlash {
      0%, 97%, 100% { opacity: 0; }
      98% { opacity: 0.8; }
      99% { opacity: 0; }
    }
  </style>
</head>
<body>
  <div class="weather-bg" id="weatherBackground"></div>

  <div class="container">
    <h2>üå¶Ô∏è Weather Now üå¶Ô∏è </h2>
    <input type="text" id="cityInput" placeholder="Enter city name">
    <button onclick="getWeather()">Search</button>
    <button onclick="getGeoWeather()">üìç Current</button>

    <div style="margin-top: 10px;">
      <select id="unitSelect">
        <option value="metric">¬∞C</option>
        <option value="imperial">¬∞F</option>
      </select>

      <select id="langSelect">
        <option value="en">English</option>
        <option value="hi">‡§π‡§ø‡§®‡•ç‡§¶‡•Ä</option>
        <option value="es">Espa√±ol</option>
        <option value="fr">Fran√ßais</option>
        <option value="de">Deutsch</option>
      </select>

      <button class="toggle-btn" onclick="toggleTheme()">üåì Mode</button>
    </div>

    <div id="weather" class="weather"></div>
    <div id="forecast" class="forecast"></div>
    <div id="error" class="error"></div>
  </div>

  <footer>¬© 2025 Riya Katiyar.  work.riyakatiyar@gmail.com  . All rights reserved.</footer>

  <script>
    const apiKey = 'ead2a0fb100f83fe591ba9eaf39c8bf8'; <!-- Get your own API key -->

    function setWeatherBackground(condition) {
      const bg = document.getElementById("weatherBackground");
      bg.innerHTML = ""; // Clear old elements

      if (condition.includes("rain")) {
        for (let i = 0; i < 100; i++) {
          const drop = document.createElement("div");
          drop.className = "rain";
          drop.style.left = `${Math.random() * 100}vw`;
          drop.style.animationDuration = `${0.5 + Math.random()}s`;
          bg.appendChild(drop);
        }
      } else if (condition.includes("clear")) {
        const sun = document.createElement("div");
        sun.className = "sun-rays";
        bg.appendChild(sun);
      } else if (condition.includes("cloud")) {
        ["cloud1", "cloud2", "cloud3"].forEach(cls => {
          const cloud = document.createElement("div");
          cloud.className = `cloud ${cls}`;
          bg.appendChild(cloud);
        });
      } else if (condition.includes("snow")) {
        for (let i = 0; i < 50; i++) {
          const flake = document.createElement("div");
          flake.className = "snowflake";
          flake.textContent = "‚ùÑ";
          flake.style.left = `${Math.random() * 100}vw`;
          flake.style.top = `${Math.random() * -100}vh`;
          flake.style.animationDuration = `${5 + Math.random() * 5}s`;
          bg.appendChild(flake);
        }
      } else if (condition.includes("thunderstorm")) {
        const flash = document.createElement("div");
        flash.className = "lightning";
        bg.appendChild(flash);
      } else if (condition.includes("mist") || condition.includes("fog")) {
        const fog = document.createElement("div");
        fog.className = "fog";
        bg.appendChild(fog);
      }
    }

    async function getWeather(city = null, lat = null, lon = null) {
      const unit = document.getElementById('unitSelect').value;
      const lang = document.getElementById('langSelect').value;
      const error = document.getElementById('error');
      const weatherDiv = document.getElementById('weather');
      const forecastDiv = document.getElementById('forecast');
      error.innerText = '';
      weatherDiv.innerHTML = '';
      forecastDiv.innerHTML = '';

      let url = '';
      if (city) {
        url = `https://api.openweathermap.org/data/2.5/weather?q=${city}&units=${unit}&lang=${lang}&appid=${apiKey}`;
      } else if (lat && lon) {
        url = `https://api.openweathermap.org/data/2.5/weather?lat=${lat}&lon=${lon}&units=${unit}&lang=${lang}&appid=${apiKey}`;
      } else {
        error.innerText = "Please enter a city or allow location.";
        return;
      }

      try {
        const res = await fetch(url);
        const data = await res.json();

        if (data.cod !== 200) {
          error.innerText = data.message;
          return;
        }

        const { name, main, weather, wind, sys, coord } = data;
        const iconUrl = `https://openweathermap.org/img/wn/${weather[0].icon}@2x.png`;

        setWeatherBackground(weather[0].main.toLowerCase());

        weatherDiv.innerHTML = `
          <h3>${name}, ${sys.country}</h3>
          <img src="${iconUrl}" alt="${weather[0].description}" />
          <p><strong>${main.temp}¬∞</strong> - ${weather[0].description}</p>
          <p>Humidity: ${main.humidity}% | Wind: ${wind.speed} ${unit === 'metric' ? 'm/s' : 'mph'}</p>
        `;

        getForecast(coord.lat, coord.lon, unit, lang);
      } catch (e) {
        error.innerText = "Error fetching weather data.";
      }
    }

    async function getForecast(lat, lon, unit, lang) {
      const forecastDiv = document.getElementById('forecast');
      try {
        const res = await fetch(`https://api.openweathermap.org/data/2.5/onecall?lat=${lat}&lon=${lon}&exclude=current,minutely,hourly,alerts&units=${unit}&lang=${lang}&appid=${apiKey}`);
        const data = await res.json();

        let forecastHTML = `<h3>7-Day Forecast</h3>`;
        data.daily.slice(1, 8).forEach(day => {
          const date = new Date(day.dt * 1000);
          const icon = `https://openweathermap.org/img/wn/${day.weather[0].icon}@2x.png`;
          forecastHTML += `
            <div class="forecast-day">
              <strong>${date.toLocaleDateString(lang, { weekday: 'short' })}</strong>
              <img src="${icon}" alt="${day.weather[0].description}" />
              <p>${day.temp.day}¬∞</p>
            </div>
          `;
        });

        forecastDiv.innerHTML = forecastHTML;
      } catch {
        forecastDiv.innerHTML = "Error loading forecast.";
      }
    }

    function getGeoWeather() {
      if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(pos => {
          getWeather(null, pos.coords.latitude, pos.coords.longitude);
        }, () => {
          document.getElementById('error').innerText = "Geolocation failed.";
        });
      } else {
        document.getElementById('error').innerText = "Geolocation not supported.";
      }
    }

    function toggleTheme() {
      document.body.classList.toggle("light-mode");
    }

    document.getElementById("cityInput").addEventListener("keypress", function (e) {
      if (e.key === "Enter") {
        getWeather(document.getElementById("cityInput").value);
      }
    });
  </script>
</body>
</html>
